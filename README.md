# Video Recommendation Engine

The Video Recommendation Engine is an AI-driven search and recommendation system designed to deliver far more relevant video results than standard YouTube search. Rather than relying solely on title or simple in-text matches from autogenerated subtitles, this engine extracts meaningful topics from video transcripts using AI and semantic embeddings. It then uses these insights to rank and return the top matching videos based on your search query.

## Why This Engine?

- **Semantic Understanding:**  
  The engine uses state-of-the-art AI to extract topics from YouTube’s autogenerated subtitles. This deeper understanding goes beyond plain keyword matching.
  
- **Topic-Based Search:**  
  Videos are represented by the topics extracted from their transcripts and are embedded in a high-dimensional space. This allows for accurate semantic search using cosine similarity.
  
- **Superior Results:**  
  By focusing on the core themes and ideas discussed in the videos, the engine provides recommendations that are more aligned with user intent than YouTube’s basic text-based search.

## Project Structure

```
Recommendation Service/
├── prepare_backend.py          # Prepares videos_topics_embedded.csv from videos.csv and transcripts
├── search_videos.py            # Contains the search_videos function for query processing
├── transcribe_videos.py        # Transcribes videos; requires a .log file with video titles and URLs as input
├── helpers/
│   ├── embeddings_dataframe.py # Functions for working with embeddings DataFrame
│   ├── topic_extraction.py     # Functions for extracting topics from transcripts
│   └── topics_embedding.py     # Functions for embedding topics using OpenAI API
├── transcripts/                # Contains transcripts for each video
└── WebApp/
    ├── app.py                # Flask web application for the search interface
    └── templates/
        ├── index.html        # Home page with search bar and disclaimer
        └── results.html      # Results page displaying embedded videos, titles, similarity scores, and topics
```

## Setup Tutorial

### 1. Extract Videos from a Channel

First, extract videos from a YouTube channel using a browser-based tool. We followed the tutorial from [9meters](https://9meters.com/entertainment/streaming/get-all-video-titles-and-links-urls-from-a-youtube-channel-online), which creates a CSV log file (with columns `title` and `url`).

### 2. Transcribe Videos

Run the transcription script:

```bash
python transcribe_videos.py
```

When prompted, provide the CSV log file generated in step 1. This script will:
- Create a `videos.csv` file containing video metadata.
- Save individual transcript files in the `transcripts` folder.

### 3. Prepare the Backend

Next, run the backend preparation script:

```bash
python prepare_backend.py
```

This script processes `videos.csv` and the transcripts to extract topics from each video, computes embeddings for these topics using OpenAI’s API, and produces (or updates) the `videos_topics_embedded.csv` file.

### 4. Run the WebApp

Now, start the search web application:

```bash
cd WebApp
python app.py
```

Your Flask app will start (by default on `http://127.0.0.1:5000/`). Open this URL in your browser.

### 5. Use the Search Engine

On the home page, enter a search query and hit "Search."  
The app will:
- Embed your query.
- Search the precomputed topics embeddings for the most similar videos.
- Present the top 10 results with embedded YouTube players, video titles, similarity scores, and the extracted topics below each result.

## Dependencies

Make sure you have the following installed (preferably in a virtual environment):

- Python 3.9 or higher
- Flask
- pandas
- openai
- faiss-cpu (or faiss-gpu if you have GPU support)
- (Optional) Other dependencies as noted in individual scripts

You can install the core dependencies via pip:

```bash
pip install flask pandas openai faiss-cpu
```

## Notes

- **API Keys & Configuration:**  
  Ensure you have your OpenAI API key set up as an environment variable before running scripts that call the OpenAI API.

- **Adapt to Your Needs:**  
  This service is far from complete and probably not instantly usable without some knowledge of how to adapt it to your use case. This was used for a personal project and only later adapted to be published for everyones use.

---

Happy searching, and may your journey through video wisdom be enlightened!